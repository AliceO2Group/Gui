<!doctype html>
<title>ChartTimeSerie</title>
<link rel="stylesheet" href="../../Frontend/css/src/bootstrap.css">

<script type="module">
import {mount, h, Observable, chartTimeSerie} from '../../Frontend/js/src/index.js';

// Example of chart integration with template engine
const view = (model) => [
  h('div.m4', [
    chartTimeSerie({
      serie: model.serie1,
      title: 'Sinus',
      colorPrimary: 'red',
      width: '800',
    }),
  ]),
  h('div.m4', [
    chartTimeSerie({
      serie: model.serie1,
      title: 'Sinus',
      colorPrimary: 'red',
      width: '800',
      timeScale: 100,
    }),
  ]),
  h('div.m4', [
    chartTimeSerie({
      serie: model.serie2,
      title: 'Random',
      colorPrimary: 'blue',
      width: '800',
    }),
  ]),
  h('div.m4', [
    chartTimeSerie({
      serie: model.serie3,
      title: 'Sinus rounded',
      colorPrimary: 'green',
      width: '800',
    }),
  ]),
];

// Create some basic model
const model = new Observable();
model.serie1 = [];
model.serie2 = [];
model.serie3 = [];
model.notify();

// Add points at 30 FPS but keep only first 800 points for memory leak
let i = 0;
setInterval(() => {
  i++;
  model.serie1.push({value: Math.cos(i / 10), timestamp: Date.now()});
  model.serie2.push({value: Math.random() * 10, timestamp: Date.now()});
  model.serie3.push({value: Math.round(Math.cos(i / 10)), timestamp: Date.now()});

  model.serie1.splice(0, model.serie1.length - 800);
  model.serie2.splice(0, model.serie2.length - 800);
  model.serie3.splice(0, model.serie3.length - 800);

  model.notify();
}, 33);

mount(document.body, view, model, true);

window.model = model;

</script>
